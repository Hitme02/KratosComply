{
  "report_version": "1.0",
  "project": {
    "name": "sample-app",
    "path": "/Users/user/Desktop/KratosCompliance/examples/sample-app",
    "commit": "6b776e41cbc381989c744bc02e35c61c5b3da3be",
    "scan_time": "2025-12-19T14:16:55.883032+00:00"
  },
  "standards": [
    "DPDP",
    "GDPR",
    "ISO27001",
    "SOC2"
  ],
  "findings": [
    {
      "id": "F001",
      "type": "dpdp_missing_access_logging",
      "file": ".",
      "line": null,
      "snippet": "No access logging for personal data found",
      "severity": "high",
      "confidence": 0.7,
      "evidence_hash": "19119056342680be95bdff7e7bc1dcc49baba12a7d956e1dcd0a816a4b39e3d4",
      "compliance_frameworks_affected": [
        "DPDP",
        "GDPR"
      ],
      "control_id": "DPDP-Section-9",
      "control_category": "Logging",
      "control_pass_fail_status": "FAIL",
      "required_evidence_missing": "Missing log_proof for DPDP-Section-9",
      "auditor_explanation": "The DPDP Act (India) Section 9 and GDPR Article 30 (records of processing activities) require data fiduciaries to maintain audit logs for personal data access. Missing access logging creates an evidence gap: there is no proof that data access is monitored and auditable. Compliance requires explicit logging for all personal data access operations."
    },
    {
      "id": "F002",
      "type": "dpdp_missing_consent",
      "file": ".",
      "line": null,
      "snippet": "No consent handling mechanisms found",
      "severity": "high",
      "confidence": 0.7,
      "evidence_hash": "3cccd3de78bb41eff01c8ddd8d03ba045e79716fa097a0a5d74990bb1aa1e79d",
      "compliance_frameworks_affected": [
        "DPDP"
      ],
      "control_id": "DPDP-Section-7",
      "control_category": "Consent",
      "control_pass_fail_status": "FAIL",
      "required_evidence_missing": "Missing code_proof for DPDP-Section-7",
      "auditor_explanation": "The DPDP Act (India) Section 7 requires explicit consent for processing personal data. Missing consent handling creates an evidence gap: there is no proof that data processing complies with legal requirements. Compliance requires explicit consent mechanisms in code with audit logging."
    },
    {
      "id": "F003",
      "type": "dpdp_missing_retention",
      "file": ".",
      "line": null,
      "snippet": "No data retention configuration found",
      "severity": "medium",
      "confidence": 0.7,
      "evidence_hash": "b7d257acb8ba9956b11c2fa77b23eaea41cd6b7c067c05caa0d3a38bd7807b98",
      "compliance_frameworks_affected": [
        "DPDP"
      ],
      "control_id": "DPDP-Section-8",
      "control_category": "Retention",
      "control_pass_fail_status": "FAIL",
      "required_evidence_missing": "Missing config_proof for DPDP-Section-8",
      "auditor_explanation": "The DPDP Act (India) Section 8 requires data fiduciaries to retain personal data only as long as necessary. Missing retention configuration creates an evidence gap: there is no proof that data retention complies with legal requirements. Compliance requires explicit retention policies in configuration files or policy documents."
    },
    {
      "id": "F004",
      "type": "gdpr_missing_data_portability",
      "file": ".",
      "line": null,
      "snippet": "No data portability mechanisms found",
      "severity": "medium",
      "confidence": 0.7,
      "evidence_hash": "b135216c16212f19e72630de5ce01acc567434aa7e7fc9afc0342aef0e124e5f",
      "compliance_frameworks_affected": [
        "GDPR"
      ],
      "control_id": "GDPR-Article-20",
      "control_category": "Data Protection",
      "control_pass_fail_status": "FAIL",
      "required_evidence_missing": "Missing code_proof for GDPR-Article-20",
      "auditor_explanation": "GDPR Article 20 grants data subjects the right to data portability. Missing portability mechanisms creates an evidence gap: there is no proof that data subject rights are implemented. Compliance requires explicit data export functionality in code with audit logging."
    },
    {
      "id": "F005",
      "type": "gdpr_missing_right_to_erasure",
      "file": ".",
      "line": null,
      "snippet": "No right to erasure mechanisms found",
      "severity": "medium",
      "confidence": 0.7,
      "evidence_hash": "397828bd5faa766bf4b9453fac4b959eb749a376ec8545590597bee8352efd10",
      "compliance_frameworks_affected": [
        "GDPR"
      ],
      "control_id": "GDPR-Article-17",
      "control_category": "Data Protection",
      "control_pass_fail_status": "FAIL",
      "required_evidence_missing": "Missing code_proof for GDPR-Article-17",
      "auditor_explanation": "GDPR Article 17 grants data subjects the right to erasure of their personal data under specific circumstances. Missing erasure mechanisms creates an evidence gap: there is no proof that data subject rights are implemented. Compliance requires explicit erasure functionality in code with audit logging."
    },
    {
      "id": "F006",
      "type": "hardcoded_secret",
      "file": "app.py",
      "line": 8,
      "snippet": "PAYMENT_API_TOKEN = \"tok_live_51_insecure\"",
      "severity": "high",
      "confidence": 0.85,
      "evidence_hash": "b75710582cdd4b59f5b2653cb3116a029dea46316c3c453ed4db7d9c342ca332",
      "compliance_frameworks_affected": [
        "SOC2",
        "ISO27001",
        "DPDP",
        "GDPR"
      ],
      "control_id": "SOC2-CC6.2",
      "control_category": "Secrets Management",
      "control_pass_fail_status": "FAIL",
      "required_evidence_missing": "Missing code_proof for SOC2-CC6.2",
      "auditor_explanation": "Hardcoded secrets violate access control and data protection requirements by exposing credentials in source code. This creates both a security risk and an evidence gap: there is no proof that secrets are managed through secure, auditable channels. Compliance requires secrets to be stored in environment variables or secure vaults with access logging to meet SOC2, ISO27001, GDPR Article 32 (security of processing), and DPDP requirements."
    },
    {
      "id": "F007",
      "type": "hardcoded_secret",
      "file": "app.py",
      "line": 9,
      "snippet": "DATABASE_PASSWORD = \"p@ssw0rd!\"",
      "severity": "high",
      "confidence": 0.85,
      "evidence_hash": "a4322d1c2b1415c395e2786bccc38ceb76d81e706347fca7c7fb78b889ee19cb",
      "compliance_frameworks_affected": [
        "SOC2",
        "ISO27001",
        "DPDP",
        "GDPR"
      ],
      "control_id": "SOC2-CC6.2",
      "control_category": "Secrets Management",
      "control_pass_fail_status": "FAIL",
      "required_evidence_missing": "Missing code_proof for SOC2-CC6.2",
      "auditor_explanation": "Hardcoded secrets violate access control and data protection requirements by exposing credentials in source code. This creates both a security risk and an evidence gap: there is no proof that secrets are managed through secure, auditable channels. Compliance requires secrets to be stored in environment variables or secure vaults with access logging to meet SOC2, ISO27001, GDPR Article 32 (security of processing), and DPDP requirements."
    },
    {
      "id": "F008",
      "type": "hardcoded_secret",
      "file": "app.py",
      "line": 17,
      "snippet": "db_password: str = DATABASE_PASSWORD",
      "severity": "high",
      "confidence": 0.6,
      "evidence_hash": "6c7d9076862829754caae5be58581009704660fa81cca00e8c8e61651f657554",
      "compliance_frameworks_affected": [
        "SOC2",
        "ISO27001",
        "DPDP",
        "GDPR"
      ],
      "control_id": "SOC2-CC6.2",
      "control_category": "Secrets Management",
      "control_pass_fail_status": "FAIL",
      "required_evidence_missing": "Missing code_proof for SOC2-CC6.2",
      "auditor_explanation": "Hardcoded secrets violate access control and data protection requirements by exposing credentials in source code. This creates both a security risk and an evidence gap: there is no proof that secrets are managed through secure, auditable channels. Compliance requires secrets to be stored in environment variables or secure vaults with access logging to meet SOC2, ISO27001, GDPR Article 32 (security of processing), and DPDP requirements."
    },
    {
      "id": "F009",
      "type": "insecure_acl",
      "file": "infra/bucket.tf",
      "line": 3,
      "snippet": "acl    = \"public-read\"",
      "severity": "high",
      "confidence": 0.9,
      "evidence_hash": "fd474a04423d6766dad168e5d0a38ecb96600f449678041726960b9e0803b8db",
      "compliance_frameworks_affected": [
        "SOC2",
        "ISO27001",
        "GDPR"
      ],
      "control_id": "SOC2-CC6.1",
      "control_category": "Infrastructure Security",
      "control_pass_fail_status": "FAIL",
      "required_evidence_missing": "Missing config_proof for SOC2-CC6.1",
      "auditor_explanation": "Public-read ACLs on storage resources violate access control and data protection requirements. This creates both a security risk and an evidence gap: there is no proof that data access is restricted to authorized parties. Compliance requires explicit access policies and audit logs for all data access to meet SOC2, ISO27001, and GDPR Article 32 (security of processing) requirements."
    }
  ],
  "metrics": {
    "critical": 0,
    "high": 6,
    "medium": 3,
    "low": 0,
    "risk_score": 100
  },
  "merkle_root": "63b77120f50c9d986f1c1567ec996f3589abd23207a63059b3e66336314c5b12",
  "agent_signature": "3adc90df3e781ff8969306ca1e319d8bde5643495a7405df2fc2c8139a6eea40c977c1af4b04b87e00ef6011bb05347e9552b1da70c64b7d29ba9ab9ae1dfc09",
  "agent_version": "kratos-comply-agent-1.0.0"
}